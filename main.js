(()=>{"use strict";const e={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_disabled",inputErrorClass:"form__input_novalid"};class t{constructor(e,t,s,n){this._templateSelector=s,this._placeName=e,this._sourceLink=t,this._isLiked=!1,this._handleCardClick=n,this._element=this._getTemplate(),this._likeButton=this._element.querySelector(".element__like-button"),this._removeButton=this._element.querySelector(".element__remove-button"),this._img=this._element.querySelector(".element__img"),this._cardName=this._element.querySelector(".element__name")}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0)}_setListeners(){this._likeButton.addEventListener("click",(()=>this._like())),this._removeButton.addEventListener("click",(()=>this._remove())),this._img.addEventListener("click",(()=>this._handleCardClick(this._placeName,this._sourceLink)))}_like(){this._isLiked=!this._isLiked,this._isLiked?this._likeButton.classList.add("element__like-button_checked"):this._likeButton.classList.remove("element__like-button_checked")}_remove(){this._element.remove()}createCardElement(){return this._cardName.textContent=this._placeName,this._img.src=this._sourceLink,this._img.alt=this._placeName,this._setListeners(),this._element}}class s{constructor(e,t,s){this._popupSelector=e,this._openPopupClassname=t,this._closeButtonSelector=s,this._element=document.querySelector(e),this._handleEscCloseBinded=this._handleEscClose.bind(this)}open(){this._element.classList.add(this._openPopupClassname),document.addEventListener("keydown",this._handleEscCloseBinded)}close(){this._element.classList.remove(this._openPopupClassname),document.removeEventListener("keydown",this._handleEscCloseBinded)}_handleEscClose(e){"Escape"===e.key&&this.close()}_setEventListeners(){const e=this._element.querySelector(this._closeButtonSelector);this._element.addEventListener("click",(t=>{(t.target===this._element||t.target===e)&&this.close()}))}}class n extends s{constructor(e,t,s,n,{formSelector:i,inputSelector:o},r){super(e,t,s),this._handleSubmit=n,this._form=this._element.querySelector(i),this.inputList=Array.from(this._form.querySelectorAll(o)),this._onOpen=r,this._setEventListeners()}open(){super.open(),this._onOpen()}close(){super.close(),this._form.reset()}getInputValues(){return this.inputList.map((e=>e.value))}_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",(e=>e.preventDefault())),this._form.addEventListener("submit",(()=>this._handleSubmit()))}}class i{constructor(e,t){this._form=t,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._inputList=Array.from(t.querySelectorAll(e.inputSelector)),this._submitButton=t.querySelector(e.submitButtonSelector)}toggleButtonState(){this._hasInvalidInput()?this.disableButton(this._submitButton,this._inactiveButtonClass):this.enableButton(this._submitButton,this._inactiveButtonClass)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}checkInputValidity(e){e.validity.valid?this.hideInputError(e):this.showInputError(e,e.validationMessage)}showInputError=(e,t)=>{const s=this._form.querySelector(`#${e.id}-input-error`);e.classList.add(this._inputErrorClass),s.textContent=t};hideInputError=e=>{const t=this._form.querySelector(`#${e.id}-input-error`);e.classList.remove(this._inputErrorClass),t.textContent=""};disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}enableValidation(){this._form.addEventListener("reset",(()=>{this._inputList.forEach((e=>this.hideInputError(e)))})),this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this.checkInputValidity(e),this.toggleButtonState()}))}))}}const o=new class extends s{constructor(e,t,s,n,i){super(e,t,s),this._imgContainer=this._element.querySelector(n),this._imgCaption=this._element.querySelector(i),super._setEventListeners()}open(e,t){super.open(),this._imgContainer.src=t,this._imgContainer.alt=e,this._imgCaption.textContent=e}}(".popup_type_img","popup_opened",".popup__close-button",".img-container__img",".img-container__caption"),r=o.open.bind(o),l=(e,s,n,i)=>new t(e,s,n,i).createCardElement(),a=new class{constructor({items:e,renderer:t},s){this._renderer=t,this._items=e,this._contanerElement=document.querySelector(s)}renderItems(){this._items.forEach((e=>this._renderer(e)))}clear(){this._contanerElement.innerHTML=""}addItem(e){this._contanerElement.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{a.addItem(l(e.name,e.link,"#element",r))}},".elements");a.renderItems();const c=document.querySelector(".profile__name"),u=document.querySelector(".profile__job"),_=new class{constructor(e,t){this._profileNameContainer=e,this._profileJobContainer=t}getUserInfo(){return[this._profileNameContainer.textContent,this._profileJobContainer.textContent]}setUserInfo([e,t]){this._profileNameContainer.textContent=e,this._profileJobContainer.textContent=t}}(c,u),h=new i(e,document.querySelector("#place"));h.enableValidation();const d=new i(e,document.querySelector("#name-job"));d.enableValidation();const p=document.querySelector(".profile__edit-button"),m=new n(".popup_type_profile","popup_opened",".popup__close-button",(()=>{_.setUserInfo(m.getInputValues()),m.close()}),e,(()=>{m.inputList.forEach(((e,t)=>{e.value=_.getUserInfo()[t],d.checkInputValidity(e),d.toggleButtonState()}))}));p.addEventListener("click",(()=>m.open()));const v=document.querySelector(".profile__add-button"),k=new n(".popup_type_card","popup_opened",".popup__close-button",(()=>{const[e,t]=k.getInputValues();a.addItem(l(e,t,"#element",r)),k.close()}),e,(()=>{h.disableButton()}));v.addEventListener("click",(()=>k.open()))})();